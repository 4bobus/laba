# laba

## МОДУЛЬ 1

 Задание: 
 Необходимо разработать и настроить инфраструктуру информационно коммуникационной системы согласно предложенной топологии (см. Рисунок 1). Задание включает базовую настройку устройств: 
- присвоение имен устройствам, 
- расчет IP-адресации, 
- настройку коммутации и маршрутизации.

 В ходе проектирования и настройки сетевой инфраструктуры следует вести отчет о своих действиях, включая таблицы и схемы, предусмотренные в задании. Итоговый отчет должен содержать одну таблицу и пять отчетов о ходе работы. Итоговый отчет по окончании работы следует сохранить на диске рабочего места

![Схема топологии](<images/module1/2. топология сети.png>)

![Таблица узлов](<images/module1/1. Таблица IP-адресов.png>)

 Чтобы зайти на стенд для 1 модуля. 
 
 User name: m1  
 Password: modul1

 Перед включением виртуалок Настроем вланы. По заданию HQ-SRV в 100 влане, а  HQ-CLI в 200
 > **Примечание:**
 > Основные сведения о настройке коммутатора и выбора реализации разделения на VLAN занесите в отчёт

![](<images/module1/4. vlan.png>)

![](<images/module1/5. vlan.png>)

![](<images/module1/6. vlan.png>)

![](<images/module1/7. vlan.png>)

**ISP преднастроена, но включать ее надо**

![](<images/module1/8. таблица адресации.png>)

### Сетевая связность - между HQ и BRANCH
> **Примечание:**
> Сведения об адресах занесите в отчёт, в качестве примера используйте Таблицу 3

*HQ-RTR*

Задаём сразу FQDN - выбор имени домена произвольный:

![](<images/module1/9. сетевая связность.png>)

По такой же аналогии настройте остальные имена

Чтобы настроить адресацию переходим:

![](<images/module1/10..png>)

Заодно настроим GRE туннель

![](<images/module1/11..png>)

![](<images/module1/12..png>)

Включаем пересылку пакетов между портами (интерфейсами)

![](<images/module1/13..png>)

![](<images/module1/14..png>)

Применяем: 

***sysctl -p***

Прокинем PAT так, как по приколу тачки, что подключены к роутеру пинговать инет не будут.

![](<images/module1/15..png>)

![](<images/module1/16. nftables.png>)

Обязательно добавим в автозагрузку и активируем

![](<images/module1/17..png>)

Туннель мы допустим подняли, но чтобы пакеты через него пошли, нужна маршрутизация.
> **Примечание:**
> Сведения о настройке и защите протокола(ospf) занесите в отчёт

Установим frr.

![](<images/module1/18..png>)
> **РЕКОМЕНДАЦИЯ:**
> ПОКА FRR СКАЧИВАЕТСЯ ПЕРЕХОДИМ К НАСТРОЙКЕ BR-RTR

В файле /etc/frr/daemons - включим поддержку OSPFv2 (IPv4)

![](<images/module1/19..png>)

Не забываем перезапускать, чтобы изменения вступили в силу

![](<images/module1/20..png>)

Переходим к настройке frr (ospf)

![](<images/module1/21..png>)

Поставим пароль на frr

![](<images/module1/22..png>)

Не забываем перезапустить

![](<images/module1/23..png>)

И добавить в автозагрузку

![](<images/module1/24..png>)

*BR-RTR*

Произведем те же манипуляции

![](<images/module1/25..png>)

![](<images/module1/26..png>)

![](<images/module1/27..png>)

![](<images/module1/28..png>)

![](<images/module1/29..png>)

![](<images/module1/30..png>)

![](<images/module1/31..png>)

![](<images/module1/32..png>)

![](<images/module1/33..png>)

> **РЕКОМЕНДАЦИЯ:**
> ПОКА FRR СКАЧИВАЕТСЯ ДОДЕЛЫВАЕМ FRR НА HQ-RTR

![](<images/module1/34..png>)

![](<images/module1/35..png>)

![](<images/module1/36..png>)

![](<images/module1/37..png>)

![](<images/module1/38..png>)

![](<images/module1/39..png>)

Ура сетевая связность у между hq и br настроена

Для проверки пингуем с br-rtr:  
***ping 192.168.100.1***

> **РЕКОМЕНДАЦИЯ:**
> сразу на HQ-RTR скачаем: apt update && apt install –y isc-dhcp-server

*HQ-SRV*

Задаем имя:  
> **ВНИМАНИЕ:**
> Нужно обновить изображение

![](<images/module1/43..png>)

Прокинем инет:

![](<images/module1/40. hq-srv.png>)

Перезапускаем сервис:  
***Systemctl restart networking***

Проверяем:

![](<images/module1/41..png>)

*BR-SRV*

![](<images/module1/43..png>)

![](<images/module1/42. br-srv.png>)

Перезапускаем сервис:  
***Systemctl restart networking***

Проверяем:

![](<images/module1/41..png>)

> **РЕКОМЕНДАЦИЯ:**
> сразу скачиваем на HQ-SRV: apt update && apt install -y dnsmasq

### Создание локальных учетных записей

Создайте пользователя sshuser на серверах

*HQ-SRV и BR-SRV*

![](<images/module1/44. sshuser.png>)

Пользователь sshuser должен иметь возможность запускать sudo без дополнительной аутентификации.

В дебиане нету судо поэтому скачаем:

![](<images/module1/45..png>)

![](<images/module1/46..png>)
